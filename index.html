<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Third Space – Cellar Tools</title>
<link rel="manifest" href="manifest.json">
<style>
:root {font-family: system-ui, sans-serif;}
body{margin:0;padding:1rem;background:#f8f8f8}
nav{display:flex;gap:.5rem;margin-bottom:1rem}
button{flex:1;padding:.6rem;border:1px solid #ccc;border-radius:6px;background:#fff}
section{display:none} section.active{display:block}
input{width:6rem}
.card{background:#fff;padding:1rem;border-radius:8px;box-shadow:0 2px 6px #0002}
</style>
</head>
<body>

<nav>
  <button onclick="show('dilution')">Dilution</button>
  <button onclick="show('ibu')">IBU Adj</button>
  <!-- add more tabs later -->
</nav>

<!-- CALCULATOR 1 -->
<section id="dilution" class="active card">
  <h2>Gravity Dilution</h2>
  <label>Starting Gravity °P <input id="g0" type="number" step="0.01"></label><br>
  <label>Starting Vol bbl <input id="v0" type="number" step="0.01"></label><br>
  <label>Target Gravity °P <input id="gt" type="number" step="0.01"></label><br>
  <button onclick="solveDilution()">Calculate</button>
  <p id="dilutionOut"></p>
</section>

<!-- CALCULATOR 2 (placeholder) -->
<section id="ibu" class="card">
  <h2>IBU Adjustment</h2>
  <p>Coming soon…</p>
</section>

<script>
// tab nav
function show(id){document.querySelectorAll('section').forEach(s=>s.classList.toggle('active',s.id===id))}

// iterative dilution solver
function solveDilution(){
  const g0=+g0.value,v0=+v0.value,gt=+gt.value;
  let vW=0, gMix=g0;
  while(Math.abs(gMix-gt)>.0001){
    vW+=0.01;              // step size in bbl
    gMix=(g0*v0+1*vW)/(v0+vW);
  }
  dilutionOut.textContent=`Add ${vW.toFixed(2)} bbl of water`;
}

// PWA install/offline
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
